# 场景数据框架


## 一、概述

一般MMO的游戏由场景和场景中的对象构成，在设计地图时，就会遇到几个问题，怎么有效直观地配置信息，怎么抽象场景对象，对象都有什么功能，有什么功能是共有的。首先需要解决的是抽象出场景和场景对象以为场景对象功能，在此基础上做编辑器，用图形化的界面展示，修改储存数据，供代码使用。

</br>

## 二、场景对象结构

场景本事有数据，如场景资源，组队人数限制等等，这种信息改动不大，也比较直观，一般只要存在excel里面就好，需要的话可以做图形编辑器对excel进行读写和修改。

场景中的对象可以按需分成几类，常见的有npc，采集物，区域，点等等

### NPC

NPC主要承载了显示模型的功能，读取NPC表

### 采集物

采集物和NPC差不多，只是对话交互改成了点击采集

### 区域

区域分成了圆形区域和多边形区域，划分区域可以实现进入和离开区域的逻辑，比如划分了游泳区，飞行区等，进入以后主角切换运动状态。

### 点

点的功能比较广泛，主要用于定位，也可以添加触发组件以后实现圆形区域的功能。

### 组件

组件是对象上的属性和功能，公用的组件有缩放，大小，显示隐藏条件等，特殊的组件有巡逻，交互按钮等，按需添加，从而赋予对象特性。

![](https://raw.githubusercontent.com/dandkong/picgo/main/img/地图.png)

</br>

## 三、场景编辑器

理清了场景对象的结构以后，就可以做编辑器把数据组织起来了，场景编辑器的实现细节不多说，尽量用起来符合直观操作即可，功能如下。

1. 增删改场景信息
2. 直观展示场景中的对象（位置、模型、范围等）
3. 增删改场景中的对象
4. 修改对象的组件属性
5. 导出程序可用数据

</br>

## 四、数据载体

1.  数据可以直接导出lua，也可以导出成json，xml等，只要方便维护，程序方便调用即可。
2.  目前使用的是先储存到excel，再从excel导出到lua中，供程序调用。
3.  使用excel作为中间载体的原因可能是比较直观，但感觉使用json或者序列化的方法也是可行的。

